{% extends "base.html" %}

{% load widget_tweaks %}

{% block title %} Payment Details {% endblock title %}

{% block body %}
<div class="container">
    <h2 class="text-center">Payment Details</h2>

    <h3>Associated Payment</h3>
    <table class="table table-striped table-condensed">
        <thead>
            <tr>
                <th>Payment ID</th>
                <th>Date</th>
                <th>Type</th>
                <th>Payer Name</th>
                <th>Method</th>
                <th>Check Number</th>
                <th>Amount</th>
                <th>Applied</th>
                <th>Unapplied</th>
            <tr>
        </thead>
        <tbody>
            {% for p in payments %}
                <tr>
                    <td>{{p.pk}}</td>
                    <td>{{p.payment_date}}</td>
                    <td>{{p.payer_type}}</td>
                    <td>{{p.payer_name}}</td>
                    <td>{{p.payment_method}}</td>
                    <td>{{p.check_number}}</td>
                    <td>{{p.amount}}</td>
                    <td>{{p.applied_amount}}</td>
                    <td>{{p.unapplied_amount}}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>

    <h3>Details grouped by CPT Code</h3>
    <table class="table table-striped table-condensed">
        <thead>
            <tr>
                <th>Dt Service</th>
                <th>CPT Code</th>
                <th>Ins Charge</th>
                <th>Ins Pmt</th>
                <th>Adjusment</th>
                <th>Ins Bal</th>
                <th>Pat Resp Type</th>
                <th>Pat Charge</th>
                <th>Pat Pmt</th>
                <th>Pat Bal</th>
                <th>Total Bal</th>
            <tr>
        </thead>
        <tbody>
            {% for proc,cp in c_proc.iteritems %}
                <tr>
                    <td>{{proc.date_of_service}}</td>
                    <td>{{proc.cpt.cpt_code}}</td>
                    <td>
                        {% for c in cp.Insurance %}
                            {{c.amount}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Insurance %}
                            {{c.total_apply}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Insurance %}
                            {{c.total_adjustment}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Insurance %}
                            {{c.balance}}
                            <br>
                        {% endfor %}
                    </td>


                    <td>
                        {% for c in cp.Patient %}
                            {{c.resp_type}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Patient %}
                            {{c.amount}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Patient %}
                            {{c.total_apply}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in cp.Patient %}
                            {{c.balance}}
                            <br>
                        {% endfor %}
                    </td>
                    <td>{{proc.balance}}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock body %}
